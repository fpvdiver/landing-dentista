<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pós-Operatório – Orientações | Dra. Elen Nogata</title>
<style>
  :root{
    --brand:#0a6ebd; --brand-600:#0a66ae; --brand-50:#eff6ff;
    --text:#0f172a; --muted:#475569; --muted-2:#94a3b8;
    --bg:#ffffff; --card:#ffffff; --line:#e5e7eb; --chip:#f1f5f9; --radius:14px;
    --shadow:0 6px 24px rgba(2,6,23,.06);
  }
  *{box-sizing:border-box}
  html,body{
    margin:0;padding:0;background:var(--bg);color:var(--text);
    font:12.75px/1.45 "Inter",system-ui,-apple-system,Segoe UI,Roboto,Arial;
  }
  .page{max-width:900px;margin:26px auto;padding:22px;background:var(--card);
        border:1px solid var(--line);border-radius:20px}

  /* ====== CONFIG BAR (navbar) ====== */
  .configbar{
    position:relative;
    display:flex; gap:10px; align-items:center; margin-bottom:12px;
    padding:8px 10px;
    border-radius:14px;
    background:linear-gradient(180deg,#ffffff,#fafbff);
    border:1px solid var(--line);
    box-shadow:var(--shadow);
    flex-wrap:wrap;
  }
  .configbar .menu{ position:relative; }
  .configbar .menubtn{
    appearance:none; border:1px solid var(--line); background:#fff; color:var(--text);
    padding:9px 14px; border-radius:999px; font-weight:700; cursor:pointer;
    transition:all .15s ease; display:inline-flex; align-items:center; gap:8px;
  }
  .configbar .menubtn::after{content:"▾"; font-size:11px; color:var(--muted)}
  .configbar .menubtn:hover{ border-color:var(--brand); box-shadow:0 4px 14px rgba(2,6,23,.06) }
  .configbar .menubtn:focus{ outline:2px solid var(--brand-50); outline-offset:2px }

  .configbar .dropdown{
    position:absolute; top:110%; left:0; min-width:280px; z-index:20;
    background:#fff; border:1px solid var(--line); border-radius:12px;
    box-shadow:0 16px 40px rgba(2,6,23,.12);
    display:none; padding:8px;
  }
  .configbar .dropdown.open{ display:block; animation:ddIn .12s ease-out }
  @keyframes ddIn{ from{transform:translateY(-4px); opacity:0} to{transform:none; opacity:1}}

  .configbar .dd-title{ font-size:12px; color:var(--muted); margin:4px 8px 8px; }
  .configbar .dd-item{
    width:100%; text-align:left; padding:10px 12px; border-radius:10px;
    border:1px solid transparent; background:#fff; cursor:pointer; font-weight:600;
    transition:all .12s ease;
  }
  .configbar .dd-item:hover{ background:#f8fafc; border-color:#e5e7eb; }
  .configbar .dd-sep{ height:1px; background:#e5e7eb; margin:8px 0; }
  .configbar .spacer{ flex:1 } /* empurra os botões pra direita */

  /* botões de ação */
  .btn{
    appearance:none; border:1px solid transparent; border-radius:999px;
    font-weight:800; padding:10px 16px; cursor:pointer; transition:all .15s ease;
    display:inline-flex; align-items:center; gap:8px;
  }
  .btn:focus{ outline:2px solid var(--brand-50); outline-offset:2px }
  .btn-primary{ background:var(--brand); color:#fff; border-color:var(--brand-600) }
  .btn-primary:hover{ filter:brightness(0.96) }
  .btn-success{ background:#22c55e; color:#fff; border-color:#16a34a }
  .btn-success:hover{ filter:brightness(0.96) }

  /* ====== RESPONSIVO NAVBAR ====== */
  @media (max-width:680px){
    .configbar{ gap:8px; padding:8px }
    .configbar .menu{ width:100% }
    .configbar .menubtn{ width:100%; justify-content:space-between }
    .configbar .dropdown{
      position:static; width:100%; margin-top:6px; display:none;
    }
    .configbar .dropdown.open{ display:block }
    .configbar .actions{ width:100%; display:flex; gap:8px }
    .configbar .actions .btn{ flex:1; justify-content:center }
  }

  /* ====== HEADER ====== */
  header{
    position:relative;
    display:grid;
    grid-template-columns: 1fr auto;
    align-items:center;
    gap:14px;
    margin-bottom:8px;
  }
  .logo-wrap{ grid-column:1 / -1; display:flex; justify-content:center; align-items:center; }
  .logo{
    width:377px; height:85px; border-radius:14px; overflow:hidden;
    display:flex; align-items:center; justify-content:center;
  }
  .logo img{width:90%; height:330%; object-fit:contain; display:block}
  .clinic-box{ grid-column:2 / 3; justify-self:end; text-align:right; }
  .clinic-box h1{margin:0;font-size:18px;letter-spacing:.2px}
  .clinic-box .meta{color:var(--muted);font-size:12px}

  .hr{height:1px;background:var(--line);margin:12px 0}

  h2.title{margin:0 0 4px 0;font-size:17px;text-align:center}
  .subtitle{color:var(--muted);font-size:11.5px;text-align:center;margin-bottom:10px}

  /* ====== TABELAS ====== */
  .section{margin-top:12px;page-break-inside:avoid}
  .section h3{margin:0 0 6px 0;font-size:14px;color:var(--brand)}

  .info-table{width:100%;border-collapse:separate;border-spacing:0;overflow:hidden;
              border-radius:14px;border:1px solid var(--line)}
  .info-table thead th{background:var(--brand);color:#fff;text-align:left;padding:8px 10px;font-size:12.25px}
  .info-table td{padding:8px 10px;border-top:1px solid var(--line);vertical-align:top}
  .info-table tbody tr:nth-child(odd) td{background:#f8fafc}
  .chip{display:inline-block;background:var(--chip);padding:4px 8px;border-radius:999px;
        font-size:11px;color:var(--muted)}

  /* ====== MASCOTE NO BLOCO HERO ====== */
  .hero-wrap{ position:relative; }
  .mascote{
    position:absolute; left:28px; top:-18px; width:150px; height:auto;
    filter:drop-shadow(0 2px 0 rgba(0,0,0,.06)); user-select:none; pointer-events:none;
  }
  .pad-left-mascote{ padding-left:160px }
  @media (max-width:845px){
    .mascote{ left:-15px; top:-35px; width:149px }
    .pad-left-mascote{ padding-left:140px }
  }
  @media (max-width:933px){
    .mascote{ left:-23px; top:-49px; width:145px }
    .pad-left-mascote{ padding-left:140px }
  }

  footer{margin-top:14px;display:flex;align-items:center;justify-content:space-between;gap:12px;
         font-size:11.5px;color:var(--muted)}
  .brand-badge{display:inline-flex;align-items:center;gap:8px;background:var(--chip);padding:6px 10px;border-radius:999px}

  /* ====== PRINT (PDF) ====== */
  @page { size: A4; margin: 14mm; }
  @media print{
    html,body{font-size:12px}
    .page{margin:0;border:none;border-radius:0}
    .configbar{display:none !important}

    .hero-wrap{ position:relative }
    .mascote{
      position:absolute !important; width:230px !important; left:-10px !important; top:-200px !important;
      margin:0 !important; print-color-adjust:exact; -webkit-print-color-adjust:exact;
    }
    .pad-left-mascote{ padding-left:180px !important }

    *{-webkit-print-color-adjust:exact !important; print-color-adjust:exact !important}
    .info-table thead th{background:#0a6ebd !important; color:#fff !important}
    .info-table tbody tr:nth-child(odd) td{background:#f8fafc !important}
    .info-table{border-color:#e5e7eb !important}
    .info-table td{border-top-color:#e5e7eb !important}
    .chip{background:#f1f5f9 !important; color:#475569 !important}
    .brand-badge{background:#f1f5f9 !important; color:#475569 !important}

    .print-lines{ display:block !important; text-align:right; margin-top:2px; }
    .print-line{ display:block !important; font-weight:600; margin:0; }
    .print-line small{ color:#64748b !important; font-weight:700 }
    #print-proc{display:none !important}
  }

  .print-lines{ display:none }
  .print-line{ font-weight:600 }
  .print-line small{font-weight:700; color:var(--muted-2)}
</style>
</head>
<body>
  <div class="page">

    <!-- ====== NAVBAR (menus + ações) ====== -->
    <nav class="configbar" aria-label="Configurações">
      <div class="menu" id="m-proc">
        <button class="menubtn" type="button">Procedimentos</button>
        <div class="dropdown" role="menu" id="dd-proc">
          <div class="dd-title">Selecione um procedimento</div>
          <div id="dd-proc-list"></div>
        </div>
      </div>

      <div class="menu" id="m-address">
        <button class="menubtn" type="button">Endereço</button>
        <div class="dropdown" role="menu" id="dd-address">
          <div class="dd-title">Endereços cadastrados</div>
          <div id="dd-address-list"></div>
          <div class="dd-sep"></div>
          <button class="dd-item" type="button" id="dd-new-address">Outro endereço…</button>
        </div>
      </div>

      <div class="menu" id="m-logo">
        <button class="menubtn" type="button">Logo</button>
        <div class="dropdown" role="menu">
          <button class="dd-item" type="button" id="dd-edit-logo">Editar a logo</button>
        </div>
      </div>

      <div class="menu" id="m-dados">
        <button class="menubtn" type="button">Dados</button>
        <div class="dropdown" role="menu">
          <button class="dd-item" type="button" id="dd-edit-nome">Alterar nome</button>
          <button class="dd-item" type="button" id="dd-edit-cro">Alterar CROSP</button>
        </div>
      </div>

      <div class="spacer"></div>

      <div class="actions">
        <button class="btn btn-primary" id="btn-pdf" type="button">Gerar PDF</button>
        <button class="btn btn-success" id="btn-share" type="button">Compartilhar</button>
      </div>
    </nav>

    <header>
      <div class="logo-wrap">
        <div class="logo">
          <img id="logo-img" src="../../images/elenlogopng.png" alt="Logo Dra. Elen Nogata" />
        </div>
      </div>
      <div class="clinic-box">
        <h1 id="clinic-name">Dra. Elen Nogata</h1>
        <div class="meta">CROSP: <span id="clinic-cro">76.956</span></div>
      </div>
    </header>

    <div class="hr"></div>

    <!-- Linhas para o PDF (direita) -->
    <div class="print-lines">
      <div class="print-line" id="print-address"><small>Endereço:</small> <span></span></div>
      <div class="print-line" id="print-proc"><small>Procedimento:</small> <span></span></div>
    </div>

    <h2 class="title" id="doc-title">Cuidados Pós-Operatórios – Exodontia de Siso</h2>
    <div class="subtitle" id="doc-subtitle">Primeiras 72h são decisivas para cicatrização</div>

    <!-- ====== HERO / PRÓXIMOS PASSOS ====== -->
    <section class="section hero-wrap" aria-label="Mensagem e próximos passos">
      <img class="mascote" src="../../images/avatarElen.png" alt="Mensagem da equipe" />
      <table class="info-table">
        <thead>
          <tr><th style="width:40%"></th><th>Próximos passos</th></tr>
        </thead>
        <tbody id="tb-hero">
          <tr>
            <td class="pad-left-mascote"></td>
            <td>Selecione o procedimento acima para ver as orientações específicas da sua recuperação.</td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- Seções -->
    <section class="section">
      <h3 id="h24h">Primeiras 24 horas</h3>
      <table class="info-table" aria-label="Primeiras 24 horas">
        <thead><tr><th>Orientação</th><th>Detalhes</th></tr></thead>
        <tbody id="tb-24h"></tbody>
      </table>
    </section>

    <section class="section">
      <h3>Medicação</h3>
      <table class="info-table" aria-label="Medicação">
        <thead><tr><th>Item</th><th>Orientação</th></tr></thead>
        <tbody id="tb-med"></tbody>
      </table>
    </section>

    <section class="section">
      <h3>Alimentação</h3>
      <table class="info-table" aria-label="Alimentação">
        <thead><tr><th>Preferir</th><th>Evitar</th></tr></thead>
        <tbody id="tb-alim"></tbody>
      </table>
    </section>

    <section class="section">
      <h3>Higiene</h3>
      <table class="info-table" aria-label="Higiene">
        <thead><tr><th>Escovação</th><th>Enxágue</th></tr></thead>
        <tbody id="tb-hig"></tbody>
      </table>
    </section>

    <section class="section">
      <h3 id="h-extra">Cuidados adicionais</h3>
      <table class="info-table" aria-label="Cuidados adicionais">
        <thead><tr><th>Item</th><th>Orientação</th></tr></thead>
        <tbody id="tb-extra"></tbody>
      </table>
    </section>

    <section class="section">
      <h3>Retorno e sinais de alerta</h3>
      <table class="info-table" aria-label="Retorno">
        <thead><tr><th>Retorno</th><th>Contate a clínica se houver</th></tr></thead>
        <tbody id="tb-ret"></tbody>
      </table>
    </section>

    <footer>
      <div class="brand-badge"><strong>Dra. Elen Nogata</strong> · CROSP 76.956</div>
      <div>Documento informativo – siga sempre as recomendações da sua cirurgiã</div>
    </footer>
  </div>

  <script>
    /* ========= STORAGE KEYS ========= */
    const ADDR_STORAGE_KEY = "posimplante_enderecos_v1";
    const LOGO_STORAGE_KEY = "posimplante_logo_url_v1";
    const NAME_STORAGE_KEY = "posimplante_nome_v1";
    const CRO_STORAGE_KEY  = "posimplante_cro_v1";

    /* ========= ENDEREÇOS ========= */
    const DEFAULT_ADDR = [
      "Rua Cincinato Braga, 321 cj. 82 – Bela Vista, São Paulo/SP · Tel: (11) 99819-4004"
    ];
    function loadAddrs(){
      try{
        const data = JSON.parse(localStorage.getItem(ADDR_STORAGE_KEY));
        return Array.isArray(data) && data.length ? data : DEFAULT_ADDR.slice();
      }catch{ return DEFAULT_ADDR.slice(); }
    }
    function saveAddrs(list){ localStorage.setItem(ADDR_STORAGE_KEY, JSON.stringify(list)); }
    let selectedAddrIndex = 0;

    /* ========= PROCEDIMENTOS ========= */
    const PROCS = [
      {key:"siso",         label:"Pós-Exo de Siso"},
      {key:"extracao",     label:"Pós-Extração"},
      {key:"canal",        label:"Pós-Tratamento de Canal"},
      {key:"restauracao",  label:"Pós-Restauração"},
      {key:"limpeza",      label:"Pós-Limpeza"},
      {key:"clareamento",  label:"Pós-Clareamento"},
      {key:"implante",     label:"Pós-Implante (modelo)"}
    ];
    let currentProcKey = "siso";
    let currentProcLabel = PROCS.find(p=>p.key===currentProcKey).label;

    /* ========= CONFIG BAR: build menus ========= */
    const ddAddressList = document.getElementById('dd-address-list');
    const ddProcList = document.getElementById('dd-proc-list');

    function rebuildAddressDropdown(){
      const addrs = loadAddrs();
      ddAddressList.innerHTML = addrs.map((a,i)=>`
        <button class="dd-item" data-addr-idx="${i}" type="button">${a}</button>
      `).join('');
      ddAddressList.querySelectorAll('.dd-item').forEach(btn=>{
        btn.addEventListener('click', e=>{
          selectedAddrIndex = Number(e.currentTarget.getAttribute('data-addr-idx'));
          updatePrintMirrors();
          closeAllDropdowns();
        });
      });
    }
    document.getElementById('dd-new-address').addEventListener('click', ()=>{
      const val = prompt("Digite o novo endereço:");
      if(!val) return;
      const list = loadAddrs(); list.push(val.trim());
      saveAddrs(list); selectedAddrIndex = list.length-1;
      rebuildAddressDropdown(); updatePrintMirrors(); closeAllDropdowns();
    });

    function buildProcDropdown(){
      ddProcList.innerHTML = PROCS.map(p=>`
        <button class="dd-item" data-proc="${p.key}" type="button">${p.label}</button>
      `).join('');
      ddProcList.querySelectorAll('.dd-item').forEach(btn=>{
        btn.addEventListener('click', e=>{
          const key = e.currentTarget.getAttribute('data-proc');
          const label = PROCS.find(p=>p.key===key)?.label || "";
          setProcedure(key, label);
          closeAllDropdowns();
        });
      });
    }

    /* ========= LOGO / DADOS ========= */
    const logoImg = document.getElementById('logo-img');
    const clinicName = document.getElementById('clinic-name');
    const clinicCro  = document.getElementById('clinic-cro');

    (function initBranding(){
      const logoUrl = localStorage.getItem(LOGO_STORAGE_KEY);
      if(logoUrl) logoImg.src = logoUrl;
      const nm = localStorage.getItem(NAME_STORAGE_KEY);
      if(nm) clinicName.textContent = nm;
      const cro = localStorage.getItem(CRO_STORAGE_KEY);
      if(cro) clinicCro.textContent = cro;
    })();

    document.getElementById('dd-edit-logo').addEventListener('click', ()=>{
      const url = prompt("Cole a URL da nova logo (PNG/SVG/JPG):", logoImg.src);
      if(!url) return;
      logoImg.src = url;
      localStorage.setItem(LOGO_STORAGE_KEY, url);
      closeAllDropdowns();
    });
    document.getElementById('dd-edit-nome').addEventListener('click', ()=>{
      const v = prompt("Nome para exibir:", clinicName.textContent);
      if(!v) return;
      clinicName.textContent = v.trim();
      localStorage.setItem(NAME_STORAGE_KEY, v.trim());
      closeAllDropdowns();
    });
    document.getElementById('dd-edit-cro').addEventListener('click', ()=>{
      const v = prompt("CROSP (apenas números e pontos):", clinicCro.textContent);
      if(!v) return;
      clinicCro.textContent = v.trim();
      localStorage.setItem(CRO_STORAGE_KEY, v.trim());
      closeAllDropdowns();
    });

    /* ========= AÇÕES: PDF e Compartilhar ========= */
    const btnPdf = document.getElementById('btn-pdf');
    const btnShare = document.getElementById('btn-share');

    btnPdf.addEventListener('click', ()=> window.print());

    btnShare.addEventListener('click', async ()=>{
      // Tenta compartilhar a página (link). Para compartilhar um PDF,
      // o fluxo recomendado é: gerar e salvar o PDF pelo botão acima e,
      // em seguida, compartilhar o arquivo salvo pelo sistema.
      try{
        if (navigator.share){
          await navigator.share({
            title: document.title,
            text: "Orientações pós-operatórias (PDF disponível via 'Gerar PDF').",
            url: location.href
          });
        }else{
          await navigator.clipboard.writeText(location.href);
          alert("Link copiado para a área de transferência.");
        }
      }catch(e){}
    });

    // dropdown toggles
    document.querySelectorAll('.configbar .menubtn').forEach(btn=>{
      btn.addEventListener('click', e=>{
        const dd = e.currentTarget.parentElement.querySelector('.dropdown');
        const open = dd.classList.contains('open');
        closeAllDropdowns();
        if(!open) dd.classList.add('open');
      });
    });
    function closeAllDropdowns(){ document.querySelectorAll('.configbar .dropdown').forEach(d=>d.classList.remove('open')); }
    document.addEventListener('click', (e)=>{ if(!e.target.closest('.configbar')) closeAllDropdowns(); });

    /* ========= DADOS POR PROCEDIMENTO (iguais) ========= */
    const DATA = { /* … todo o objeto DATA do seu código atual … */ };

    /* ========= RENDER ========= */
    const $ = s => document.querySelector(s);
    function renderTable(tbody, rows){
      tbody.innerHTML = rows.map(r => `<tr><td>${r[0]}</td><td>${r[1]}</td></tr>`).join("");
    }
    function render(procKey){
      const d = DATA[procKey] || DATA.siso;
      $("#doc-title").textContent = d.title;
      $("#doc-subtitle").textContent = d.subtitle || "";
      $("#tb-hero").innerHTML = `<tr><td class="pad-left-mascote"></td><td>${d.hero}</td></tr>`;
      renderTable($("#tb-24h"), d._24h);
      renderTable($("#tb-med"), d.med);
      renderTable($("#tb-alim"), d.alim);
      renderTable($("#tb-hig"), d.hig);
      document.getElementById("h-extra").textContent = d.extraTitle || "Cuidados adicionais";
      renderTable($("#tb-extra"), d.extra);
      renderTable($("#tb-ret"), d.ret);
      updatePrintMirrors();
    }

    /* ========= SELECTORS ========= */
    function setProcedure(key,label){
      currentProcKey = key;
      currentProcLabel = label || (PROCS.find(p=>p.key===key)?.label||"");
      render(key);
    }
    function updatePrintMirrors(){
      const addrText = loadAddrs()[selectedAddrIndex] || "";
      document.querySelector("#print-address span").textContent = addrText;
      document.querySelector("#print-proc span").textContent = currentProcLabel;
    }

    /* ========= INIT ========= */
    buildProcDropdown();
    rebuildAddressDropdown();
    setProcedure(currentProcKey, currentProcLabel);
  </script>
</body>
</html>
