<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="dentista, clínica odontológica, implantes, ortodontia, estética dental" />
  <meta name="description" content="Clínica odontológica moderna com atendimento especializado." />
  <meta name="author" content="OdontoPrime" />
  <link rel="shortcut icon" href="images/favicon.png" type="">
<<<<<<< HEAD
  <title>Elen Nogata</title>
=======
  <title>OdontoPrime</title>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
  <!--owl slider stylesheet -->
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
  <!-- nice select  -->
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css" />
  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
</head>

<body>

  <div class="hero_area">
  <div class="bg-box">
    <img src="images/hero-bg.jpg" alt="">
    <div class="overlay"></div> <!-- overlay escuro -->
  </div>
    <!-- header section -->
    <header class="header_section">
      <div class="container">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <span>Elen Nogata</span>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent">
            <span class=""> </span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mx-auto ">
              <li class="nav-item active">
                <a class="nav-link" href="index.html">Início</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="menu.html">Serviços</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="about.html">Profissional</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="book.html">Agendar Consulta</a>
              </li>
            </ul>
            <div class="user_option">
              <a href="tel:+5511999999999" class="order_online">Ligue Agora</a>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- slider section -->
    <section class="slider_section">
      <div id="customCarousel1" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="container ">
              <div class="row">
                <div class="col-md-7 col-lg-6">
                  <div class="detail-box">
                    <h1>Sorriso Saudável</h1>
                    <p>Tratamentos odontológicos modernos e acessíveis, para devolver a confiança ao seu sorriso.</p>
                    <div class="btn-box">
                      <a href="book.html" class="btn1">Agendar Consulta</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="carousel-item ">
            <div class="container ">
              <div class="row">
                <div class="col-md-7 col-lg-6">
                  <div class="detail-box">
                    <h1>Atendimento Humanizado</h1>
                    <p>Cuidamos da sua saúde bucal com carinho, tecnologia e uma equipe altamente qualificada.</p>
                    <div class="btn-box">
                      <a href="menu.html" class="btn1">Conheça os Serviços</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <ol class="carousel-indicators">
          <li data-target="#customCarousel1" data-slide-to="0" class="active"></li>
          <li data-target="#customCarousel1" data-slide-to="1"></li>
        </ol>
      </div>
    </section>
  </div>

  <!-- services section (usando as imagens originais de "menu") -->
  <section class="food_section layout_padding-bottom">
    <div class="container">
      <div class="heading_container heading_center">
        <h2>Nossos Serviços</h2>
      </div>
      <div class="row grid">
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f1.png" alt=""></div>
            <div class="detail-box">
              <h5>Implantes Dentários</h5>
              <p>Reposição segura e duradoura de dentes perdidos.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f2.png" alt=""></div>
            <div class="detail-box">
              <h5>Ortodontia</h5>
              <p>Aparelhos modernos para alinhar seu sorriso com conforto e estética.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f3.png" alt=""></div>
            <div class="detail-box">
              <h5>Estética Dental</h5>
              <p>Clareamento, facetas e soluções para deixar seus dentes ainda mais bonitos.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="btn-box">
        <a href="menu.html">Ver Todos os Serviços</a>
      </div>
    </div>
  </section>

  <!-- about section -->
<<<<<<< HEAD
  <section class="about_section layout_padding_profissional">
=======
  <section class="about_section layout_padding">
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
    <div class="container">
      <div class="row">
        <div class="col-md-6 ">
          <div class="img-box">
            <img src="images/about-img.png" alt="">
          </div>
        </div>
        <div class="col-md-6">
          <div class="detail-box">
<<<<<<< HEAD
            <h2>Dra Elen Nogata</h2>
            <p>Unindo tecnologia de ponta, equipe experiente e um atendimento humanizado para cuidar do seu sorriso em todas as fases da vida.</p>
=======
            <h2>Sobre a OdontoPrime</h2>
            <p>Unimos tecnologia de ponta, equipe experiente e um atendimento humanizado para cuidar do seu sorriso em todas as fases da vida.</p>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
            <a href="about.html">Saiba Mais</a>
          </div>
        </div>
      </div>
    </div>
  </section>

<<<<<<< HEAD
<!-- book section -->
=======
  <!-- book section -->
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
<section class="book_section layout_padding" id="booking">
  <div class="container">
    <div class="heading_container">
      <h2>Agende sua Consulta</h2>
      <p style="max-width:720px;color:#64748b">
        Escolha uma data para ver os horários disponíveis em tempo real. Você também pode conversar com nosso agente para agendar.
      </p>
    </div>

<<<<<<< HEAD
    <!-- lado a lado a partir de md (>=768px) -->
    <div class="row align-items-stretch">
      <!-- Coluna do formulário -->
      <div class="col-12 col-md-6 d-flex">
        <form id="booking-form" class="w-100" autocomplete="on">
          <div><input type="text" class="form-control" name="name" placeholder="Seu Nome" required /></div>
          <div><input type="tel" class="form-control" name="phone" placeholder="Telefone (WhatsApp)" required /></div>
          <div><input type="email" class="form-control" name="email" placeholder="Email" required /></div>
          <div><input type="date" class="form-control" name="date" id="booking-date" required /></div>
=======
    <div class="row">
      <div class="col-md-6">
        <form id="booking-form" autocomplete="on">
          <div>
            <input type="text" class="form-control" name="name" placeholder="Seu Nome" required />
          </div>
          <div>
            <input type="tel" class="form-control" name="phone" placeholder="Telefone (WhatsApp)" required />
          </div>
          <div>
            <input type="email" class="form-control" name="email" placeholder="Email" required />
          </div>
          <div>
            <input type="date" class="form-control" name="date" id="booking-date" required />
          </div>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d

          <!-- Grade de horários -->
          <div id="slot-container" style="margin-top:14px;">
            <div style="font-weight:700;margin-bottom:8px;">Horários</div>
            <div id="slots" class="d-flex flex-wrap" style="gap:8px;"></div>
            <small id="slot-hint" style="display:block;margin-top:6px;color:#64748b">Selecione um horário disponível.</small>
            <input type="hidden" name="time" id="selected-time" />
          </div>

          <div class="btn_box" style="margin-top:14px;">
            <button type="submit" class="btn btn-primary">Agendar Agora</button>
            <button type="button" id="open-agent" class="btn btn-outline-secondary" style="margin-left:8px;">Agendar via Chat</button>
          </div>
          <div id="booking-feedback" style="margin-top:10px;"></div>
        </form>
      </div>

<<<<<<< HEAD
      <!-- Coluna do chat -->
      <div class="col-12 col-md-6 d-flex">
        <!-- CHAT -->
        <div id="agent-widget" class="lead-chat w-100">
          <div class="lead-header">
            <div class="lead-header-left">
              <img src="images/recepcionista.png" class="lead-avatar" alt="Assistente" />
              <div>
                <div class="lead-name">Recepcionista</div>
                <div class="lead-status"><span class="dot"></span> Online agora</div>
              </div>
            </div>
            <button id="agent-minimize" class="lead-min-btn" aria-label="Minimizar">–</button>
          </div>

          <div id="agent-thread" class="lead-body"></div>

          <form id="agent-form" class="lead-inputbar" onsubmit="return false;">
            <input id="agent-input" class="lead-input" placeholder="Digite aqui..." />
            <button id="agent-send" class="lead-send" type="button" aria-label="Enviar">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M22 2L11 13" stroke="white" stroke-width="2" stroke-linecap="round"/>
                <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="white" stroke-width="2" fill="none" stroke-linejoin="round"/>
              </svg>
            </button>
          </form>
        </div>
=======
      <div class="col-md-6">
        <div class="map_container"><div id="googleMap"></div></div>
      </div>
    </div>
  </div>

  <!-- Modal simples de chat -->
  <div id="agent-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.5); z-index:1050;">
    <div style="width:100%; max-width:520px; margin:60px auto; background:#fff; border-radius:12px; overflow:hidden; box-shadow:0 20px 60px rgba(0,0,0,.25);">
      <div style="padding:12px 16px; display:flex; align-items:center; justify-content:space-between; border-bottom:1px solid #eee;">
        <strong>Agente OdontoPrime</strong>
        <button id="agent-close" class="btn btn-sm btn-light">Fechar</button>
      </div>
      <div id="agent-thread" style="height:380px; overflow:auto; padding:12px;"></div>
      <div style="display:flex; gap:6px; padding:10px; border-top:1px solid #eee;">
        <input id="agent-input" class="form-control" placeholder="Escreva sua mensagem..." />
        <button id="agent-send" class="btn btn-primary">Enviar</button>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
      </div>
    </div>
  </div>
</section>


<<<<<<< HEAD

=======
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
  <!-- footer -->
  <footer class="footer_section">
    <div class="container">
      <div class="row">
        <div class="col-md-4 footer-col">
          <h4>Contato</h4>
<<<<<<< HEAD
          <p><i class="fa fa-phone"></i> (11) 98756-2810</p>
          <p><i class="fa fa-envelope"></i> draelenogata@gmail.com</p>
=======
          <p><i class="fa fa-phone"></i> (11) 99999-9999</p>
          <p><i class="fa fa-envelope"></i> contato@odontoprime.com</p>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
        </div>
        <div class="col-md-4 footer-col">
          <h4>Endereço</h4>
          <p>Av. Paulista, 1000 - São Paulo, SP</p>
        </div>
        <div class="col-md-4 footer-col">
          <h4>Horário</h4>
          <p>Seg a Sex: 9h - 19h</p>
<<<<<<< HEAD
          <p>Sáb: 9h - 16h</p>
=======
          <p>Sáb: 9h - 14h</p>
>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d
        </div>
      </div>
    </div>
  </footer>

<<<<<<< HEAD
  
=======
  <!-- Scripts -->
<script>
/** CONFIG **/
const API_BASE = '/webhooks'; // Reverse proxy -> n8n. Ex.: /webhooks/odontoprime
const TIMEZONE = 'America/Sao_Paulo';
const SLOT_INTERVAL_MIN = 30; // deve bater com o servidor

/** Helpers **/
function el(q, root=document){ return root.querySelector(q); }
function els(q, root=document){ return Array.from(root.querySelectorAll(q)); }
function fmtMoneyBRL(v){ return (v??'').toString(); }

/** Disponibilidade **/
async function fetchAvailability(dateStr) {
  const url = `${API_BASE}/availability?date=${encodeURIComponent(dateStr)}&tz=${encodeURIComponent(TIMEZONE)}`;
  const res = await fetch(url, { headers: { 'Accept': 'application/json' }});
  if (!res.ok) throw new Error('Falha ao consultar disponibilidade');
  return res.json();
}

function rangeToSlots(start, end, stepMin) {
  const out = [];
  const [sh, sm] = start.split(':').map(Number);
  const [eh, em] = end.split(':').map(Number);
  let d = new Date(); d.setHours(sh, sm, 0, 0);
  const z = new Date(); z.setHours(eh, em, 0, 0);
  while (d < z) {
    const hh = String(d.getHours()).padStart(2,'0');
    const mm = String(d.getMinutes()).padStart(2,'0');
    out.push(`${hh}:${mm}`);
    d = new Date(d.getTime() + stepMin*60000);
  }
  return out;
}

function blockByBusy(slots, busyWindows) {
  const toMin = t => {
    const [h,m] = t.split(':').map(Number); return h*60+m;
  };
  const isBusy = (t) => busyWindows.some(([bStart,bEnd]) => {
    const tm = toMin(t), bs = toMin(bStart), be = toMin(bEnd);
    return tm >= bs && tm < be;
  });
  return slots.map(t => ({ time: t, available: !isBusy(t) }));
}

function renderSlots(availability) {
  const box = el('#slots'); box.innerHTML = '';
  const { officeHours, busy, intervalMinutes } = availability;

  const slots = rangeToSlots(officeHours.start, officeHours.end, intervalMinutes || SLOT_INTERVAL_MIN);
  const withStatus = blockByBusy(slots, busy || []);
  withStatus.forEach(s => {
    const b = document.createElement('button');
    b.type = 'button';
    b.className = 'slot btn btn-sm ' + (s.available ? '' : 'disabled');
    b.textContent = s.time;
    b.disabled = !s.available;
    b.addEventListener('click', () => {
      if (b.classList.contains('disabled')) return;
      els('.slot.selected', box).forEach(x=>x.classList.remove('selected'));
      b.classList.add('selected');
      el('#selected-time').value = s.time;
    });
    box.appendChild(b);
  });

  // Dica se nenhum disponível
  if (!withStatus.some(s=>s.available)) {
    const msg = document.createElement('div');
    msg.style.marginTop = '8px';
    msg.style.color = '#64748b';
    msg.textContent = 'Sem horários disponíveis nesta data. Selecione outra ou fale com o agente.';
    box.appendChild(msg);
  }
}

/** Booking submit **/
async function submitBooking(payload) {
  const res = await fetch(`${API_BASE}/book`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload),
  });
  const data = await res.json().catch(()=> ({}));
  if (!res.ok) {
    const msg = data?.message || 'Não foi possível concluir o agendamento.';
    throw new Error(msg);
  }
  return data;
}

/** Chat Agent **/
async function sendAgentMessage(text, context) {
  const res = await fetch(`${API_BASE}/agent`, {
    method: 'POST',
    headers: {'Content-Type':'application/json'},
    body: JSON.stringify({ message: text, context }),
  });
  const data = await res.json();
  if (!res.ok) throw new Error(data?.message || 'Falha no agente');
  return data;
}

/** Wire-up **/
document.addEventListener('DOMContentLoaded', () => {
  const dateInput = el('#booking-date');
  // min hoje, max 60 dias
  const today = new Date(); today.setHours(0,0,0,0);
  dateInput.min = today.toISOString().slice(0,10);
  const max = new Date(today.getTime() + 60*24*3600*1000);
  dateInput.max = max.toISOString().slice(0,10);

  dateInput.addEventListener('change', async (e) => {
    el('#selected-time').value = '';
    try {
      const data = await fetchAvailability(e.target.value);
      renderSlots(data);
    } catch (err) {
      el('#slots').innerHTML = '<div style="color:#dc2626">Erro ao carregar horários.</div>';
      console.error(err);
    }
  });

  el('#booking-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    const fd = new FormData(e.currentTarget);
    const date = fd.get('date');
    const time = fd.get('time');
    if (!time) {
      el('#booking-feedback').innerHTML = '<div class="text-danger">Selecione o horário.</div>';
      return;
    }
    const payload = {
      name: fd.get('name'),
      phone: fd.get('phone'),
      email: fd.get('email'),
      date, time,
      tz: TIMEZONE,
      source: 'web-form',
      idempotencyKey: crypto?.randomUUID?.() || (Date.now()+'-'+Math.random())
    };
    el('#booking-feedback').innerHTML = 'Processando...';
    try {
      const resp = await submitBooking(payload);
      el('#booking-feedback').innerHTML = `<div class="text-success">Agendado! Confirmação enviada. Código: ${resp.eventId}</div>`;
      // opcional: redirect para "obrigado"
    } catch (err) {
      el('#booking-feedback').innerHTML = `<div class="text-danger">${err.message}</div>`;
    }
  });

  // Chat modal
  const modal = el('#agent-modal');
  el('#open-agent').addEventListener('click', () => { modal.style.display='block'; bootAgent(); });
  el('#agent-close').addEventListener('click', () => { modal.style.display='none'; });
  el('#agent-send').addEventListener('click', sendMsg);
  el('#agent-input').addEventListener('keypress', (ev) => { if (ev.key==='Enter') sendMsg(); });

  function appendMsg(role, content) {
    const area = el('#agent-thread');
    const bubble = document.createElement('div');
    bubble.style.margin = '6px 0';
    bubble.style.whiteSpace = 'pre-wrap';
    bubble.innerHTML = `<div style="font-size:12px;color:#64748b">${role==='user'?'Você':'Agente'}</div><div>${content}</div>`;
    area.appendChild(bubble);
    area.scrollTop = area.scrollHeight;
  }

  async function bootAgent() {
    el('#agent-thread').innerHTML = '';
    appendMsg('assistant', 'Olá! Posso verificar horários e concluir seu agendamento. Diga seu nome, data desejada e preferência de horário.');
  }

  async function sendMsg() {
    const input = el('#agent-input');
    const text = (input.value || '').trim(); if (!text) return;
    appendMsg('user', text); input.value = '';
    const context = {
      tz: TIMEZONE,
      // Pre-contexto com infos do formulário, caso já preenchidas:
      prefill: {
        name: el('input[name="name"]').value,
        phone: el('input[name="phone"]').value,
        email: el('input[name="email"]').value,
      }
    };
    try {
      const data = await sendAgentMessage(text, context);
      appendMsg('assistant', data.reply || 'Ok.');
      // Se o agente já reservou, podemos dar feedback
      if (data.booking && data.booking.status === 'confirmed') {
        el('#booking-feedback').innerHTML =
          `<div class="text-success">Agendado via agente! Código: ${data.booking.eventId}</div>`;
      }
    } catch (err) {
      appendMsg('assistant', 'Tive um problema ao processar. Tente novamente.');
      console.error(err);
    }
  }
});
</script>

>>>>>>> fdcf979c87956821270b9cc6b81f8118b436e51d

  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="js/booking.js"></script>
  <script src="js/custom.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
</body>
</html>
