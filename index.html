<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="dentista, clínica odontológica, implantes, ortodontia, estética dental" />
  <meta name="description" content="Clínica odontológica moderna com atendimento especializado." />
  <meta name="author" content="OdontoPrime" />
  <link rel="shortcut icon" href="images/favicon.png" type="">
  <title>Elen Nogata</title>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
  <!--owl slider stylesheet -->
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
  <!-- nice select  -->
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css" />
  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
</head>

<body>

  <div class="hero_area">
  <div class="bg-box">
    <img src="images/hero-bg.jpg" alt="">
    <div class="overlay"></div> <!-- overlay escuro -->
  </div>
    <!-- header section -->
    <header class="header_section">
      <div class="container">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <span>Elen Nogata</span>
          </a>
          <button class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent">
            <span class=""> </span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mx-auto ">
              <li class="nav-item active">
                <a class="nav-link" href="index.html">Início</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="menu.html">Serviços</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="about.html">Profissional</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="book.html">Agendar Consulta</a>
              </li>
            </ul>
            <div class="user_option">
              <a href="tel:+5511999999999" class="order_online">Ligue Agora</a>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- slider section -->
    <section class="slider_section">
      <div id="customCarousel1" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
          <div class="carousel-item active">
            <div class="container ">
              <div class="row">
                <div class="col-md-7 col-lg-6">
                  <div class="detail-box">
                    <h1>Sorriso Saudável</h1>
                    <p>Tratamentos odontológicos modernos e acessíveis, para devolver a confiança ao seu sorriso.</p>
                    <div class="btn-box">
                      <a href="book.html" class="btn1">Agendar Consulta</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="carousel-item ">
            <div class="container ">
              <div class="row">
                <div class="col-md-7 col-lg-6">
                  <div class="detail-box">
                    <h1>Atendimento Humanizado</h1>
                    <p>Cuidamos da sua saúde bucal com carinho, tecnologia e uma equipe altamente qualificada.</p>
                    <div class="btn-box">
                      <a href="menu.html" class="btn1">Conheça os Serviços</a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <ol class="carousel-indicators">
          <li data-target="#customCarousel1" data-slide-to="0" class="active"></li>
          <li data-target="#customCarousel1" data-slide-to="1"></li>
        </ol>
      </div>
    </section>
  </div>

  <!-- services section (usando as imagens originais de "menu") -->
  <section class="food_section layout_padding-bottom">
    <div class="container">
      <div class="heading_container heading_center">
        <h2>Nossos Serviços</h2>
      </div>
      <div class="row grid">
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f1.png" alt=""></div>
            <div class="detail-box">
              <h5>Implantes Dentários</h5>
              <p>Reposição segura e duradoura de dentes perdidos.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f2.png" alt=""></div>
            <div class="detail-box">
              <h5>Ortodontia</h5>
              <p>Aparelhos modernos para alinhar seu sorriso com conforto e estética.</p>
            </div>
          </div>
        </div>
        <div class="col-sm-6 col-lg-4 all">
          <div class="box">
            <div class="img-box"><img src="images/f3.png" alt=""></div>
            <div class="detail-box">
              <h5>Estética Dental</h5>
              <p>Clareamento, facetas e soluções para deixar seus dentes ainda mais bonitos.</p>
            </div>
          </div>
        </div>
      </div>
      <div class="btn-box">
        <a href="menu.html">Ver Todos os Serviços</a>
      </div>
    </div>
  </section>

  <!-- about section -->
  <section class="about_section layout_padding_profissional">
    <div class="container">
      <div class="row">
        <div class="col-md-6 ">
          <div class="img-box">
            <img src="images/about-img.png" alt="">
          </div>
        </div>
        <div class="col-md-6">
          <div class="detail-box">
            <h2>Dra Elen Nogata</h2>
            <p>Unindo tecnologia de ponta, equipe experiente e um atendimento humanizado para cuidar do seu sorriso em todas as fases da vida.</p>
            <a href="about.html">Saiba Mais</a>
          </div>
        </div>
      </div>
    </div>
  </section>

<!-- ================== BOOKING WIDGET (calendário + slots) ================== -->
<style>
  .bk-card{border:1px solid var(--ring,#e5e7eb); border-radius:16px; background:#fff; padding:14px}
  .bk-head{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
  .bk-head .month{font-weight:800}
  .bk-btn-link{background:none; border:0; padding:6px 10px; border-radius:10px}
  .bk-cal{user-select:none}
  .bk-dow, .bk-grid{display:grid; grid-template-columns:repeat(7,1fr)}
  .bk-dow{gap:4px; color:#6b7280; font-size:.8rem; margin:6px 0}
  .bk-dow div{padding:6px; text-align:center}
  .bk-grid{gap:6px}
  .bk-day{position:relative; text-align:center; padding:10px 0; border-radius:12px; cursor:pointer; transition:.2s}
  .bk-day:hover{background:#f3f4f6}
  .bk-day.out{opacity:.35; cursor:default}
  .bk-day .num{font-weight:600}
  .bk-day .dot{position:absolute; left:50%; transform:translateX(-50%); bottom:6px; width:6px; height:6px; border-radius:999px; background:#22c55e; opacity:.15}
  .bk-day.avail .dot{opacity:1}
  .bk-day.sel{background:#e0f2fe; outline:2px solid #bae6fd}
  .bk-slots-title{font-weight:700; margin:12px 0 6px}
  .bk-slots{display:flex; flex-wrap:wrap; gap:8px}
  .bk-slot{border:1px solid #e5e7eb; background:#fff; padding:.45rem .7rem; border-radius:999px; font-size:.95rem}
  .bk-slot:hover{border-color:#cbd5e1}
  .bk-slot[disabled]{opacity:.35; cursor:not-allowed}
  .bk-slot.active{background:#0ea5e9; border-color:#0ea5e9; color:#fff}
  .bk-actions{display:flex; gap:10px; margin-top:12px}
  @media (min-width: 992px){
    .bk-wrap{display:grid; grid-template-columns: 360px 1fr; gap:16px}
  }
</style>

<div class="bk-wrap">
  <!-- Coluna esquerda: calendário -->
  <div class="bk-card">
    <div class="bk-head">
      <button class="bk-btn-link" id="bk-prev" aria-label="Mês anterior">
        <i class="fa-solid fa-chevron-left"></i>
      </button>
      <div class="month" id="bk-month">—</div>
      <button class="bk-btn-link" id="bk-next" aria-label="Próximo mês">
        <i class="fa-solid fa-chevron-right"></i>
      </button>
    </div>

    <div class="bk-cal">
      <div class="bk-dow">
        <div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>Sáb</div>
      </div>
      <div class="bk-grid" id="bk-grid"></div>
    </div>
  </div>

  <!-- Coluna direita: dados + horários + ação -->
  <div>
    <div class="bk-card">
      <div class="form-group mb-2">
        <input id="bk-name" class="form-control" placeholder="Seu Nome">
      </div>
      <div class="form-group mb-2">
        <input id="bk-phone" class="form-control" placeholder="Telefone (WhatsApp)">
      </div>
      <div class="form-group mb-2">
        <input id="bk-email" class="form-control" placeholder="Email">
      </div>

      <div class="bk-slots-title">
        Horários <span id="bk-day-label" class="text-muted" style="font-weight:500"></span>
      </div>
      <div id="bk-slots" class="bk-slots">Selecione um dia do calendário…</div>

      <div class="bk-actions">
        <button id="bk-submit" class="btn btn-primary btn-pill" disabled>Agendar Agora</button>
        <a id="bk-chat" class="btn btn-outline-secondary btn-pill" target="_blank" rel="noopener">Agendar via Chat</a>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // ========= CONFIG =========
  const BASE = (window.CRM_API_BASE || 'https://allnsnts.app.n8n.cloud/webhook/odonto').replace(/\/+$/,'');
  const TZ   = window.TIMEZONE || 'America/Sao_Paulo';

  // ========= HELPERS =========
  const el  = (q,root=document)=>root.querySelector(q);
  const els = (q,root=document)=>Array.from(root.querySelectorAll(q));
  const pad2 = n => String(n).padStart(2,'0');
  const ymd  = d => `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
  const fmtBR = iso => { try{const [y,m,d]=iso.split('-');return `${d}/${m}/${y}`;}catch{return iso;} };

  function rangeToSlots(start,end,stepMin){
    const out=[], [sh,sm]=start.split(':').map(Number), [eh,em]=end.split(':').map(Number);
    let d=new Date(); d.setHours(sh,sm,0,0); const z=new Date(); z.setHours(eh,em,0,0);
    while(d<z){ out.push(`${pad2(d.getHours())}:${pad2(d.getMinutes())}`); d=new Date(d.getTime()+stepMin*60000); }
    return out;
  }
  function blockByBusy(slots, busy){
    const toMin=t=>{const [h,m]=t.split(':').map(Number);return h*60+m;};
    return slots.map(t=>{
      const tm=toMin(t);
      const busyNow=(busy||[]).some(([bStart,bEnd])=>tm>=toMin(bStart)&&tm<toMin(bEnd));
      return { time:t, available:!busyNow };
    });
  }

  // ========= API =========
  async function fetchAvailability(dateStr){
    const url=`${BASE}/availability?date=${encodeURIComponent(dateStr)}&tz=${encodeURIComponent(TZ)}`;
    const res=await fetch(url,{headers:{Accept:'application/json'}});
    if(!res.ok) throw new Error('Falha ao consultar disponibilidade');
    return res.json();
  }
  async function submitBooking(payload){
    // Usa CRMApi se existir, senão cai no endpoint do n8n
    if (window.CRMApi?.createAppointment) {
      return CRMApi.createAppointment(payload);
    }
    const res = await fetch(`${BASE}/appointments/create`,{
      method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(payload)
    });
    const data = await res.json().catch(()=>({}));
    if(!res.ok) throw new Error(data?.message || 'Erro ao agendar');
    return data;
  }

  // ========= STATE =========
  const gMonth  = el('#bk-month');
  const gGrid   = el('#bk-grid');
  const btnPrev = el('#bk-prev');
  const btnNext = el('#bk-next');
  const lblDay  = el('#bk-day-label');
  const slotsEl = el('#bk-slots');
  const btnGo   = el('#bk-submit');
  const btnChat = el('#bk-chat');

  const inName  = el('#bk-name');
  const inPhone = el('#bk-phone');
  const inEmail = el('#bk-email');

  let anchor  = new Date(); // mês atual
  let selDate = new Date(); // dia escolhido
  let selTime = '';         // horário escolhido

  // ========= CALENDAR =========
  function buildMonthHeader(){
    const m = anchor.toLocaleDateString('pt-BR', { month:'long', year:'numeric' });
    gMonth.textContent = m.charAt(0).toUpperCase()+m.slice(1);
  }
  function startOfMonth(d){ return new Date(d.getFullYear(), d.getMonth(), 1); }
  function endOfMonth(d){ return new Date(d.getFullYear(), d.getMonth()+1, 0); }

  function dayHTML(d,{out=false,avail=false,sel=false}={}){
    return `
      <div class="bk-day ${out?'out':''} ${avail?'avail':''} ${sel?'sel':''}" data-date="${ymd(d)}" ${out?'data-out="1"':''}>
        <span class="num">${d.getDate()}</span>
        <span class="dot"></span>
      </div>`;
  }

  async function availabilityMapForMonth(days){
    // para não sobrecarregar, consulta em blocos
    const map = {};
    const chunks = [];
    for(let i=0;i<days.length;i+=14) chunks.push(days.slice(i,i+14));
    for(const chunk of chunks){
      await Promise.all(chunk.map(async d=>{
        try{
          const a = await fetchAvailability(ymd(d));
          const slots = rangeToSlots(a?.officeHours?.start||'08:00', a?.officeHours?.end||'18:00', a?.intervalMinutes||30);
          const withStatus = blockByBusy(slots, a?.busy||[]);
          map[ymd(d)] = withStatus.some(s=>s.available);
        }catch{/* ignora erros pontuais */}
      }));
    }
    return map;
  }

  async function renderMonth(){
    buildMonthHeader();

    const first = startOfMonth(anchor);
    const last  = endOfMonth(anchor);

    const padStart = first.getDay();      // 0=Dom
    const total    = last.getDate();

    const cells = [];
    // prefixo do mês anterior
    const prevStart = new Date(first);
    prevStart.setDate(1 - padStart);
    for(let i=0;i<padStart;i++){
      const d = new Date(prevStart); d.setDate(prevStart.getDate()+i);
      cells.push({date:d, out:true});
    }
    // mês corrente
    for(let i=1;i<=total;i++){
      cells.push({date: new Date(first.getFullYear(), first.getMonth(), i), out:false});
    }
    // sufixo até múltiplo de 7
    while(cells.length % 7 !== 0){
      const d = new Date(last); d.setDate(last.getDate() + (cells.length%7));
      cells.push({date:d, out:true});
    }

    const onlyDays = cells.filter(c=>!c.out).map(c=>c.date);
    const avMap = await availabilityMapForMonth(onlyDays);

    gGrid.innerHTML = cells.map(c=>{
      const id=ymd(c.date), sel = id===ymd(selDate);
      const av = !!avMap[id];
      return dayHTML(c.date,{out:c.out,avail:av,sel});
    }).join('');

    gGrid.querySelectorAll('.bk-day').forEach(div=>{
      if (div.dataset.out === '1') return;
      div.addEventListener('click', ()=>{
        selDate = new Date(div.dataset.date);
        els('.bk-day.sel', gGrid).forEach(x=>x.classList.remove('sel'));
        div.classList.add('sel');
        loadSlotsForDay();
      });
    });
  }

  // ========= SLOTS =========
  async function loadSlotsForDay(){
    const ds = ymd(selDate);
    lblDay.textContent = '• ' + fmtBR(ds);
    selTime = '';
    btnGo.disabled = true;

    slotsEl.innerHTML = 'Carregando horários…';
    try{
      const bag = await fetchAvailability(ds);
      const start = bag?.officeHours?.start||'08:00';
      const end   = bag?.officeHours?.end  ||'18:00';
      const step  = bag?.intervalMinutes   || 30;
      const busy  = bag?.busy || [];
      const base  = rangeToSlots(start,end,step);
      const withStatus = blockByBusy(base, busy);
      if (!withStatus.some(s=>s.available)){
        slotsEl.innerHTML = '<div class="text-muted">Sem horários disponíveis neste dia.</div>';
        return;
      }
      slotsEl.innerHTML = withStatus.map(s =>
        `<button class="bk-slot ${s.available?'':'disabled'}" ${s.available?'':'disabled'} data-time="${s.time}">${s.time}</button>`
      ).join('');

      slotsEl.querySelectorAll('.bk-slot:not(.disabled)').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          els('.bk-slot.active', slotsEl).forEach(b=>b.classList.remove('active'));
          btn.classList.add('active');
          selTime = btn.dataset.time;
          btnGo.disabled = false;

          // link do WhatsApp com prefill
          const msg = encodeURIComponent(`Olá! Quero agendar ${fmtBR(ds)} às ${selTime}.`);
          const phone = (el('#bk-phone').value||'').replace(/\D/g,'');
          const to = phone && phone.length>=10 ? `55${phone}` : '';
          el('#bk-chat').href = `https://wa.me/${to}?text=${msg}`;
        });
      });
    }catch(e){
      console.error(e);
      slotsEl.innerHTML = '<div class="text-danger">Erro ao carregar horários.</div>';
    }
  }

  // ========= SUBMIT =========
  btnGo.addEventListener('click', async ()=>{
    const name  = inName.value.trim();
    const phone = inPhone.value.trim();
    const email = inEmail.value.trim();
    const date  = ymd(selDate);
    const time  = selTime;

    if (!name || !phone || !time){
      alert('Preencha nome, WhatsApp e selecione um horário.');
      return;
    }

    btnGo.disabled = true; btnGo.textContent = 'Enviando…';
    try{
      await submitBooking({
        paciente: name,
        phone, email,
        data: date,
        hora: time,
        duracaoMin: 60,           // ajuste se precisar
        procedimento: 'Consulta', // ou capte de um select
        canalPreferido: 'WhatsApp',
        tz: TZ,
        confirmar: true
      });
      alert('Agendamento confirmado ✅');
      // opcional: redirecionar para página de confirmação
    }catch(err){
      console.error(err);
      alert(err.message || 'Não foi possível agendar.');
    }finally{
      btnGo.textContent = 'Agendar Agora';
      btnGo.disabled = !selTime;
    }
  });

  // ========= NAV =========
  el('#bk-prev').addEventListener('click', ()=>{ anchor = new Date(anchor.getFullYear(), anchor.getMonth()-1, 1); renderMonth(); });
  el('#bk-next').addEventListener('click', ()=>{ anchor = new Date(anchor.getFullYear(), anchor.getMonth()+1, 1); renderMonth(); });

  // boot
  (async function init(){
    await renderMonth();
    await loadSlotsForDay();
  })();
})();
</script>
<!-- ================== /BOOKING WIDGET ================== -->



<a href="https://wa.me/5511987562810?text=Olá%20quero%20agendar%20uma%20consulta" 
   target="_blank" 
   id="whatsapp-btn">
  <img src="images/whatsappgif.gif" 
       alt="WhatsApp" />
</a>

<style>
#whatsapp-btn {
  position: fixed;
  bottom: 35px;   /* distância do fundo */
  right: 30px;    /* distância da direita */
  z-index: 9999;  /* sempre na frente */
  width: 85px;
  height: 85px;
}

#whatsapp-btn img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  border-radius: 50%;
  cursor: pointer;
  transition: transform 0.3s ease;
}

#whatsapp-btn img:hover {
  transform: scale(1.15);
}
</style>




  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <div class="row">
        <div class="col-md-4 footer-col">
          <div class="footer_contact">
            <h4>Contato</h4>
            <div class="contact_link_box">
              <a href="#"><i class="fa fa-map-marker" aria-hidden="true"></i><span>Av. Paulista, 1000 - São Paulo</span></a>
              <a href="tel:+5511999999999"><i class="fa fa-phone" aria-hidden="true"></i><span>(11) 99999-9999</span></a>
              <a href="mailto:contato@odontoprime.com"><i class="fa fa-envelope" aria-hidden="true"></i><span>contato@odontoprime.com</span></a>
            </div>
          </div>
        </div>
        <div class="col-md-4 footer-col">
          <div class="footer_detail">
            <a href="#" class="footer-logo">Dra Elen Nogata</a>
            <p>Cuidado, tecnologia e resultados que inspiram confiança ao sorrir.</p>
            <div class="footer_social">
              <a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a>
              <a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a>
              <a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a>
              <a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a>
              <a href="#"><i class="fa fa-pinterest" aria-hidden="true"></i></a>
            </div>
          </div>
        </div>
        <div class="col-md-4 footer-col">
          <h4>Horário</h4>
          <p>Seg a Sex: 9h - 19h</p>
          <p>Sáb: 9h - 14h</p>
        </div>
      </div>
      <div class="footer-info">
        <p>&copy; <span id="displayYear"></span> Lahntech. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>
  <!-- footer section -->


  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="js/bootstrap.js"></script>
  <script src="js/booking.js"></script>
  <script src="js/custom.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
</body>
</html>



























